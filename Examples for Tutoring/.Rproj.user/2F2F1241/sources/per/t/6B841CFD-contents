---
title: "Assignment 2"
author: "Marie Fester"
date: '2018-02-02'
output: pdf_document
---
# Assignment 1

```{r echo=FALSE}
setwd("/Users/mariefester/OneDrive - McGill University/school current/Winter 2018/Poli 311/Assg 2 leader assassination")
leaders <- read.csv("leaders.csv")
```

## Problem 1

```{r echo = TRUE}
numberattempts <- unique(leaders)
dim(numberattempts)

uniquecountries <- nlevels(leaders$country)
uniquecountries

leaders$dummy <- ifelse(leaders$result == "dies between a day and a week"| 
                                 leaders$result =="dies between a week and a month"| 
                                 leaders$result == "dies within a day after the attack"|
                                 leaders$result == "dies, timing unknown"|
                                 leaders$result == "hospitalization but no permanent disability"|
                                 leaders$result == "not wounded"|
                                 leaders$result == "plot stopped"|
                                 leaders$result == "survives but wounded severely"|
                                 leaders$result == "survives, whether wounded unknown"|
                                   leaders$result == "wounded lightly", 1, 0)
total.assasssinations <- tapply(leaders$dummy, leaders$country, sum)

year.range <- max(leaders$year) - min(leaders$year)
year.range

global.yearly.assassinations <- (sum(total.assasssinations)/(year.range))
global.yearly.assassinations

average.yearly.assassinations.bycountry <- (total.assasssinations/year.range)

average.yearly.assassinations.all <- mean(average.yearly.assassinations.bycountry)
average.yearly.assassinations.all
```

There are 250 leader assassination attempts in the data. There are 88 unique countries in the leaders assassination data which means that 88 countries experience at least one assassination attempt. We know that the dataset spans from the year 1878 to the year 2001, or a total of 123 years. Above is the table of average assassinations in 123 year period by country. We find that the total average assassinations in the period from 1878-2001 is 0.02309682 per year, per country, for the countries in our dataset. The average number of assassinations per year in the dataset is 2.03252.

##Problem 2

```{r echo = TRUE}
americas <- subset(leaders, leaders$continent == "Americas")

asia <- subset(leaders, leaders$continent == "Asia"|
                                leaders$region ==  "Western Asia")

europe <- subset(leaders, leaders$continent == "Europe")

americas.assassinations <- tapply(americas$dummy, americas$decade, sum)

asia.assassinations <- tapply(asia$dummy, asia$decade, sum)

europe.assassinations <- tapply(europe$dummy, europe$decade, sum)
```

```{r echo = TRUE}
plot(names(americas.assassinations), americas.assassinations, col = "black", type = "l",
     ylim = c(0, 15),
     main = "Assassinations by Decade and Region",
     xlab = "Decade",
     ylab = "Number of Assassinations")

lines(names(asia.assassinations), asia.assassinations, lty = "dotdash", type = "l")
lines(names(europe.assassinations), europe.assassinations, lty = "longdash", type = "l")

text(1980, 10, "Asia")
text(1930, 12, "Europe")
text(1890, 8, "America")
```

In Asia, there is a spike in assassinations between the 1950s and 1970s followed by a decline. The decline could be due to the democratization of many of these countries or the establishment of authoriatrian regimes that are long lasting. Also, it is interesting to see a slight spike in all three regions during the interwar years, especially after the 1929 stock market crash; perhaps an effect of the crash was dissatsifaction with political leaders and thus higher assassination rates. The assassination rate in the Americas is most steady over time, with a negative trend. Europe and Asia reached similar peaks, though in different periods. The Americas have the highest intial value, this may be due to to the American Civil War in the United States and/or democrtization in many newly independent South American and Central American states. Finally it seems like each of the three groups has a generally downward facing parabolic shape; each line starts and ends at more similar values and has a hump, somewhere in the middle, this could be showing a trend of assassinations between when an old regime starts to collapse and a new one consolidates.

## Problem 3

```{r echo = TRUE}
leaders$success <- ifelse(leaders$result == "dies between a day and a week" |
                            leaders$result == "dies within a day after the attack" |
                            leaders$result == "dies between a week and a month" |
                            leaders$result == "dies, timing unknown", 1, 0)
number.of.successes <- sum(leaders$success)
number.of.plots <- sum(leaders$dummy)
rate.of.success <- number.of.successes/number.of.plots
rate.of.success
```

In this data, there are 250 assassination attempts of which 54 were successful; there is a 0.216 rate of success. The rate of success, without any other information, is not able to determine whether assassination success is randmoly distributed or not. In order to test the distribution of successful attempts, we would have to be comparing the success rate across different variables which we may believe cause or prevent success (e.g. whether the attempt occured in a democratic or authoritarian regime). Furthermore, the dataset does not include countries that did not have assassination attempts, so we cannot see if countries with no assassaintion attempt have similar polity scores in that year, there could be a natural progression of polity scores over time.

## Problem 4

```{r echo = TRUE}
par(mfrow = c(1,2))
hist(leaders$politybefore [leaders$success == 1],
     breaks = 10,
     freq = FALSE,
     xlim = c(-10, 10),
     ylim = c(0, 0.175),
     main = "Polity Before Success",
     ylab = "Density",
     xlab = "Polity Score")
abline(v = mean(leaders$politybefore [leaders$success == 1], 
                na.rm = TRUE), col = "black")

hist(leaders$politybefore [leaders$success == 0],
     breaks = 10,
     freq = FALSE,
     xlim = c(-10, 10),
     ylim = c(0, 0.175),
     main = "Polity Before Failed",
     ylab = "Density",
     xlab = "Polity Score")
abline(v = mean(leaders$politybefore [leaders$success == 0], 
                na.rm = TRUE), col = "black")

```
```{r echo = TRUE}
qqplot(leaders$politybefore [leaders$success == 0],
       leaders$politybefore [leaders$success == 1],
       xlab = "Polity Before Failed",
       ylab = "Polity Before Successful",
       main = "Polity Score Before Assassination",
       xlim = c(-10,10),
       ylim = c(-10,10))
abline(0, 1)
```

Based on the histograms, it appears that successful assassinations occur in countries with slightly higher polity scores. However, the average polity score before was below zero for both successful and failed attempts. With regards to the assumption that we can compare between countries where assassination was successful or not (i.e. randomization is done properly), this would mean that coutries with less bad polity scores are more likely to have successful assassinations this could mean that weaker authoritarian regimes are more likely to have assassinations, perhaps because there is less fear of repercussions or a higher expectation of success. In contrast the lower polity scores may be stronger regimes which are more capable of predicting and stopping assassinations. If randomization was not done properly, then these conclusions or possible causality will be incorrect.

## Problem 5

In order to predict whether leader assassination leads to democratization, we have to see whether countries who's leaders are assassinated end up with higher polity scores afterwards. We saw in the QQ plots in question 4 that after assassinations, polity scores could get worse or better.

```{r echo = TRUE}
polity.success.before <- tapply(leaders$politybefore, leaders$success == 1, mean)
polity.success.after <- tapply(leaders$polityafter, leaders$success == 1, mean)
polity.fail.before <- tapply(leaders$politybefore, leaders$success == 0, mean)
polity.fail.after <- tapply(leaders$polityafter, leaders$success == 0, mean)
polity.fail.after - polity.fail.before
```
```{r echo = TRUE}
dead.leaders <- subset(leaders, leaders$success == 1)

cor.before.after.assassination <- cor(dead.leaders$politybefore, dead.leaders$polityafter, 
                                     use = "pairwise.complete.obs")
cor.before.after.assassination
```
```{r echo = TRUE}
plot(dead.leaders$politybefore, dead.leaders$polityafter,
     main = "Scatterplot: Successful Assa. & Polity",
     xlab = "Polity Before",
     ylab = "Polity After")

qqplot(leaders$polityafter [leaders$success == 0],
       leaders$polityafter [leaders$success == 1],
       xlab = "Polity After Failed",
       ylab = "Polity After Successful",
       main = "QQ Plot: Polity Score After Assassination",
       xlim = c(-10,10),
       ylim = c(-10,10))
abline(0, 1)

qqplot(leaders$politybefore [leaders$success == 1],
       leaders$polityafter [leaders$success == 1],
       xlab = "Polity Before Successful",
       ylab = "Polity After Successful",
       main = "QQ Plot: Polity Successful Assassinations",
       xlim = c(-10,10),
       ylim = c(-10,10))
abline(0, 1)
```

If we consider the scatterplot, we see that for most countries the before and after scores are fairly similar which tells us that assassination does not have much of an impact on democratization, however a few outliers in the top left-hand corner are countries who democratized after the assassination. The outliers in the bottom right corner became less democratic after the assassination. When we compare the means, we see that on average, polity scores feel after all assassination attmepts, this may be due to increased attention on state security for fear of more assassinations (increased security often leads to more authoritarian governance). The countries with failed attempts' polity scores fell by 0.05864198 and the countries with successful attempts fell by approximately 0.15136054. We observe a 0.7231966 correlation coefficient between countries polity scores before and after successful assassinations this means that having a low polity score or high polity score before successful assassinations leads to a very similar polity score afterwards. A correlation coefficient using the success variable is not helpful since it is a binary variable (0 or 1) and thus does not make a regular scatterplot, all the points are either 0 or 1, to compare the means by success we would need a boxplot. The quantile quantile plots also show us that successful assassinations occur in countries with slightly higher polity scores. Furthermore, polity scores are higher in countries after successful assassinations than after failed assassinations. Interestingly, the scores after the attempt remain about the same (one might expect a decline with the the introduction of a new authoritarian leader or an increase if it leads to democratization). In countries where assassinations failed, there very little variation in scores before and after the attempt, but in successful asassinations there is more variation between before and after scores (some countries do worse, some get better off). Thus, based on our data, it seems like successful assassinations reduces democraization, but there were a few outliers in the scatterplot where the assassination imporved the polity score.
 